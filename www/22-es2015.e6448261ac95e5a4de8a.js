(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{swWB:function(l,n,u){"use strict";u.r(n);var t=u("8Y7J"),o=(u("gcOT"),u("lJxs"));class e{constructor(l,n,u,t){this.afAuth=l,this.afs=n,this.http=u,this.storage=t,this.user=null,this.markers=[],this.isTracking=!1,this.anonLogin()}ionViewWillEnter(){this.storage.get("email").then(l=>{this.email=l,console.log(this.email),this.http.post("https://mywash.herokuapp.com/batch/track",{email:this.email}).subscribe(l=>{console.log(l),null!=l.data?(this.user=l.data.cleaner_name,this.phone=l.data.cleaner_phone):console.log("null")}),this.loadMap()})}loadMap(){let l={center:new google.maps.LatLng(51.9090902,7,6673267),zoom:5,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.mapElement.nativeElement,l)}call(){window.open(`tel:${this.phone}`,"_system")}anonLogin(){this.afAuth.auth.signInAnonymously().then(l=>{console.log(l)}).then(()=>{this.findloc()})}findloc(){console.log("loc called"),this.locationsCollection=this.afs.collection("locations/cleaner1/track",l=>l.orderBy("timestamp","desc")),this.locations=this.locationsCollection.snapshotChanges().pipe(Object(o.a)(l=>l.map(l=>{const n=l.payload.doc.data();return Object.assign({id:l.payload.doc.id},n)}))),this.locations.subscribe(l=>{console.log("paused",l),setTimeout(()=>{console.log("update called"),this.markers.map(l=>l.setMap(null)),this.markers=[];let n=new google.maps.LatLng(l[0].lat,l[0].lng);this.map.setCenter(n),this.map.setZoom(14);let u=new google.maps.Marker({map:this.map,position:n});this.markers.push(u)},2e3)})}deleteLocation(l){this.locationsCollection.doc(l.id).delete()}}class i{}var a=u("pMnS"),s=u("oBZk"),b=u("ZZ/e"),c=u("SVse"),r=u("iInd"),p=u("irV9"),m=u("Xr7G"),h=u("IheW"),d=u("xgBC"),g=t.zb({encapsulation:0,styles:[["#map[_ngcontent-%COMP%]{width:100%;height:300px}"]],data:{}});function k(l){return t.Vb(0,[(l()(),t.Bb(0,0,null,null,16,"ion-item-sliding",[],null,null,null,s.bb,s.u)),t.Ab(1,49152,null,0,b.O,[t.j,t.p,t.F],null,null),(l()(),t.Bb(2,0,null,0,8,"ion-item",[],null,null,null,s.cb,s.r)),t.Ab(3,49152,null,0,b.J,[t.j,t.p,t.F],null,null),(l()(),t.Bb(4,0,null,0,6,"ion-label",[["text-wrap",""]],null,null,null,s.db,s.v)),t.Ab(5,49152,null,0,b.P,[t.j,t.p,t.F],null,null),t.Ab(6,16384,null,0,b.e,[t.p],null,null),(l()(),t.Tb(7,0,[" Lat: "," Lng: "," "])),(l()(),t.Bb(8,0,null,0,2,"p",[],null,null,null,null,null)),(l()(),t.Tb(9,null,[" "," "])),t.Pb(10,2),(l()(),t.Bb(11,0,null,0,5,"ion-item-options",[["side","start"]],null,null,null,s.ab,s.t)),t.Ab(12,49152,null,0,b.N,[t.j,t.p,t.F],{side:[0,"side"]},null),(l()(),t.Bb(13,0,null,0,3,"ion-item-option",[["color","danger"]],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.deleteLocation(l.context.$implicit)&&t),t}),s.Z,s.s)),t.Ab(14,49152,null,0,b.M,[t.j,t.p,t.F],{color:[0,"color"]},null),(l()(),t.Bb(15,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,s.X,s.p)),t.Ab(16,49152,null,0,b.E,[t.j,t.p,t.F],{name:[0,"name"]},null)],(function(l,n){l(n,12,0,"start"),l(n,14,0,"danger"),l(n,16,0,"trash")}),(function(l,n){l(n,7,0,n.context.$implicit.lat,n.context.$implicit.lng);var u=t.Ub(n,9,0,l(n,10,0,t.Nb(n.parent.parent,0),n.context.$implicit.timestamp,"short"));l(n,9,0,u)}))}function A(l){return t.Vb(0,[(l()(),t.Bb(0,0,null,null,17,"div",[],null,null,null,null,null)),(l()(),t.Bb(1,0,null,null,4,"ion-item",[],null,null,null,s.cb,s.r)),t.Ab(2,49152,null,0,b.J,[t.j,t.p,t.F],null,null),(l()(),t.Bb(3,0,null,0,2,"ion-label",[],null,null,null,s.db,s.v)),t.Ab(4,49152,null,0,b.P,[t.j,t.p,t.F],null,null),(l()(),t.Tb(5,0,["User ID: ",""])),(l()(),t.Bb(6,0,null,null,6,"ion-item",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.call()&&t),t}),s.cb,s.r)),t.Ab(7,49152,null,0,b.J,[t.j,t.p,t.F],null,null),(l()(),t.Bb(8,0,null,0,2,"ion-label",[],null,null,null,s.db,s.v)),t.Ab(9,49152,null,0,b.P,[t.j,t.p,t.F],null,null),(l()(),t.Tb(10,0,["Contact: ",""])),(l()(),t.Bb(11,0,null,0,1,"ion-icon",[["name","call-sharp"]],null,null,null,s.X,s.p)),t.Ab(12,49152,null,0,b.E,[t.j,t.p,t.F],{name:[0,"name"]},null),(l()(),t.Bb(13,0,null,null,4,"ion-list",[],null,null,null,s.eb,s.w)),t.Ab(14,49152,null,0,b.Q,[t.j,t.p,t.F],null,null),(l()(),t.qb(16777216,null,0,2,null,k)),t.Ab(16,278528,null,0,c.j,[t.X,t.S,t.x],{ngForOf:[0,"ngForOf"]},null),t.Ob(131072,c.b,[t.j])],(function(l,n){var u=n.component;l(n,12,0,"call-sharp"),l(n,16,0,t.Ub(n,16,0,t.Nb(n,17).transform(u.locations)))}),(function(l,n){var u=n.component;l(n,5,0,u.user),l(n,10,0,u.phone)}))}function B(l){return t.Vb(0,[t.Ob(0,c.e,[t.z]),t.Rb(671088640,1,{mapElement:0}),(l()(),t.Bb(2,0,null,null,13,"ion-header",[],null,null,null,s.W,s.o)),t.Ab(3,49152,null,0,b.D,[t.j,t.p,t.F],null,null),(l()(),t.Bb(4,0,null,0,11,"ion-toolbar",[],null,null,null,s.pb,s.H)),t.Ab(5,49152,null,0,b.Eb,[t.j,t.p,t.F],null,null),(l()(),t.Bb(6,0,null,0,6,"ion-buttons",[["slot","start"]],null,null,null,s.L,s.d)),t.Ab(7,49152,null,0,b.n,[t.j,t.p,t.F],null,null),(l()(),t.Bb(8,0,null,0,4,"ion-back-button",[["routerDirection","backward"],["routerLink","/tabs/tabs/services"]],null,[[null,"click"]],(function(l,n,u){var o=!0;return"click"===n&&(o=!1!==t.Nb(l,10).onClick(u)&&o),"click"===n&&(o=!1!==t.Nb(l,11).onClick()&&o),"click"===n&&(o=!1!==t.Nb(l,12).onClick(u)&&o),o}),s.J,s.b)),t.Ab(9,49152,null,0,b.i,[t.j,t.p,t.F],null,null),t.Ab(10,16384,null,0,b.j,[[2,b.kb],b.Kb],null,null),t.Ab(11,16384,null,0,r.n,[r.m,r.a,[8,null],t.K,t.p],{routerLink:[0,"routerLink"]},null),t.Ab(12,737280,null,0,b.Pb,[c.i,b.Kb,t.p,r.m,[2,r.n]],{routerDirection:[0,"routerDirection"]},null),(l()(),t.Bb(13,0,null,0,2,"ion-title",[],null,null,null,s.ob,s.G)),t.Ab(14,49152,null,0,b.Cb,[t.j,t.p,t.F],null,null),(l()(),t.Tb(-1,0,[" Live Tracking "])),(l()(),t.Bb(16,0,null,null,10,"ion-content",[],null,null,null,s.S,s.k)),t.Ab(17,49152,null,0,b.w,[t.j,t.p,t.F],null,null),(l()(),t.Bb(18,0,[[1,0],["map",1]],0,0,"div",[["id","map"]],[[8,"hidden",0]],null,null,null,null)),(l()(),t.Bb(19,0,null,0,5,"ion-item",[["class","align-items-center"]],null,null,null,s.cb,s.r)),t.Ab(20,49152,null,0,b.J,[t.j,t.p,t.F],null,null),(l()(),t.Bb(21,0,null,0,3,"ion-label",[],[[8,"hidden",0]],null,null,s.db,s.v)),t.Ab(22,49152,null,0,b.P,[t.j,t.p,t.F],null,null),(l()(),t.Bb(23,0,null,0,1,"b",[],null,null,null,null,null)),(l()(),t.Tb(-1,null,["No cleaner assigned yet"])),(l()(),t.qb(16777216,null,0,1,null,A)),t.Ab(26,16384,null,0,c.k,[t.X,t.S],{ngIf:[0,"ngIf"]},null)],(function(l,n){var u=n.component;l(n,11,0,"/tabs/tabs/services"),l(n,12,0,"backward"),l(n,26,0,u.user)}),(function(l,n){var u=n.component;l(n,18,0,!u.user),l(n,21,0,u.user)}))}function L(l){return t.Vb(0,[(l()(),t.Bb(0,0,null,null,1,"app-gps",[],null,null,null,B,g)),t.Ab(1,49152,null,0,e,[p.a,m.a,h.c,d.b],null,null)],null,null)}var f=t.xb("app-gps",e,L,{},{},[]),j=u("s7LF");u.d(n,"GpsPageModuleNgFactory",(function(){return F}));var F=t.yb(i,[],(function(l){return t.Kb([t.Lb(512,t.m,t.jb,[[8,[a.a,f]],[3,t.m],t.D]),t.Lb(4608,c.m,c.l,[t.z,[2,c.t]]),t.Lb(4608,j.k,j.k,[]),t.Lb(4608,b.c,b.c,[t.F,t.g]),t.Lb(4608,b.Jb,b.Jb,[b.c,t.m,t.w]),t.Lb(4608,b.Ob,b.Ob,[b.c,t.m,t.w]),t.Lb(1073742336,c.c,c.c,[]),t.Lb(1073742336,j.j,j.j,[]),t.Lb(1073742336,j.c,j.c,[]),t.Lb(1073742336,b.Gb,b.Gb,[]),t.Lb(1073742336,r.o,r.o,[[2,r.t],[2,r.m]]),t.Lb(1073742336,i,i,[]),t.Lb(1024,r.k,(function(){return[[{path:"",component:e}]]}),[])])}))}}]);