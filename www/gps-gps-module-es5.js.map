{"version":3,"sources":["src/app/gps/gps.page.html","src/app/gps/gps.module.ts","src/app/gps/gps.page.scss","src/app/gps/gps.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-title>\\n      Live Tracking\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n \\n<ion-content>\\n \\n  <div #map id=\\\"map\\\" [hidden]=\\\"!user\\\"></div>\\n \\n  <div *ngIf=\\\"user\\\">\\n \\n    <ion-item>\\n      <ion-label>User ID: {{ user.uid }}</ion-label>\\n    </ion-item>\\n \\n    <ion-button expand=\\\"block\\\" (click)=\\\"startTracking()\\\" *ngIf=\\\"!isTracking\\\">\\n      <ion-icon name=\\\"locate\\\" slot=\\\"start\\\"></ion-icon>\\n      Start Tracking\\n    </ion-button>\\n \\n    <ion-button expand=\\\"block\\\" (click)=\\\"stopTracking()\\\" *ngIf=\\\"isTracking\\\">\\n      <ion-icon name=\\\"hand\\\" slot=\\\"start\\\"></ion-icon>\\n      Stop Tracking\\n    </ion-button>\\n \\n    <ion-list>\\n      <ion-item-sliding *ngFor=\\\"let pos of locations | async\\\">\\n        <ion-item>\\n          <ion-label text-wrap>\\n            Lat: {{ pos.lat }}\\n            Lng: {{ pos.lng }}\\n            <p>\\n              {{ pos.timestamp | date:'short' }}\\n            </p>\\n          </ion-label>\\n        </ion-item>\\n \\n        <ion-item-options side=\\\"start\\\">\\n          <ion-item-option color=\\\"danger\\\" (click)=\\\"deleteLocation(pos)\\\">\\n            <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n          </ion-item-option>\\n        </ion-item-options>\\n \\n      </ion-item-sliding>\\n    </ion-list>\\n \\n  </div>\\n \\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { GpsPage } from './gps.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: GpsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [GpsPage]\n})\nexport class GpsPageModule {}\n","export default \"#map {\\n  width: 100%;\\n  height: 300px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvZ3BzL0Q6XFxTRU04XFxwMy9zcmNcXGFwcFxcZ3BzXFxncHMucGFnZS5zY3NzIiwic3JjL2FwcC9ncHMvZ3BzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQTtFQUNJLFdBQUE7RUFDQSxhQUFBO0FDQUoiLCJmaWxlIjoic3JjL2FwcC9ncHMvZ3BzLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4jbWFwe1xyXG4gICAgd2lkdGg6MTAwJTtcclxuICAgIGhlaWdodDogMzAwcHg7XHJcbn0iLCIjbWFwIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMzAwcHg7XG59Il19 */\"","import { Component, ViewChild, ElementRef } from '@angular/core';\nimport {Plugins, GeolocationPluginWeb} from '@capacitor/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { Observable } from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport { AngularFirestoreCollection, AngularFirestore } from '@angular/fire/firestore';\n\n\nconst {Geolocation} =Plugins;\n\n declare var google;\n\n@Component({\n  selector: 'app-gps',\n  templateUrl: 'gps.page.html',\n  styleUrls: ['gps.page.scss'],\n})\nexport class GpsPage {\n  locations:Observable<any>;\n  locationsCollection: AngularFirestoreCollection<any>;\n  user=null;\n\n  @ViewChild('map',{static:false}) mapElement:ElementRef;\n  map:any;\n  markers=[];\n  isTracking = false;\n  watch: string;\n  constructor(\n    private afAuth:AngularFireAuth,\n    private afs:AngularFirestore) {\n    this.anonLogin();\n  }\n\n  ionViewWillEnter(){\n    this.loadMap();\n  }\n  loadMap(){\n    let latlng=new google.maps.LatLng(51.9090902,7,6673267);\n\n    let mapOptions={\n      center:latlng,\n      zoom:5,\n      mapTypeId:google.maps.MapTypeId.ROADMAP\n    };\n    this.map=new google.maps.Map(this.mapElement.nativeElement,mapOptions);\n  }\n  \n  anonLogin(){\n    //email auth\n    this.afAuth.auth.signInAnonymously().then(user=>{\n      console.log(user);\n      this.user=user;\n    }).then(()=>{\n      this.findloc();\n    });\n  }\n\n\n  findloc(){\n      this.locationsCollection=this.afs.collection(\n        `locations/cleaner1/track`,\n        ref=>ref.orderBy('timestamp',\"desc\")\n      );\n      \n      this.locations = this.locationsCollection.snapshotChanges().pipe(\n        map(actions =>\n          actions.map(a => {\n            const data = a.payload.doc.data();\n            const id = a.payload.doc.id;\n            return { id, ...data };\n          })\n        )\n      );\n \n      this.locations.subscribe(locations => {\n        this.updateMap(locations);\n      });\n\n  }\n\n  // Delete a location from Firebase\n  deleteLocation(pos) {\n    this.locationsCollection.doc(pos.id).delete();\n\n  }\n   \n  // Redraw all markers on the map\n  updateMap(locations) {\n    // Remove all current marker\n    console.log(\"update called\",locations);\n    \n    this.markers.map(marker => marker.setMap(null));\n    this.markers = [];\n    // for (let loc of locations) {\n      let latLng = new google.maps.LatLng(locations[0].lat, locations[0].lng);\n      this.map.setCenter(latLng);\n      this.map.setZoom(14);\n\n      let marker = new google.maps.Marker({\n        map: this.map,\n        animation: google.maps.Animation.DROP,\n        position: latLng\n      });\n      this.markers.push(marker);\n\n      setTimeout(()=>{this.findloc();},10000);\n    // }\n  }\n}\n"],"sourceRoot":"webpack:///","file":"gps-gps-module-es5.js"}